# حلقه ها در bash

تو تمامی زبان ها برنامه نویسی حلقه ها (loop) داریم که کار باهاشم خیلی راحته. از حلقه ها برای انجام یه کار تکراری استفاده میکنن، مثلا میخواید یه عدد بگیرید و اون عدد رو به تعداد همون عدد چاپ کنید، اونوقت نمیاید الکی دستور اضافه کنید، میاید و از حلقه ها استفاده میکنید (بیکار نیستید الکی تکراری بنویسید)

داخل bash ما 3 نوع حلقه داریم به نام های `for` ، `while` و `until` که باهم میریم بررسیشون کنیم

## حلقه for - For loops

ساختار این حلقه به این صورته:

```bash
for var in ${list}
do
    your_commands
done
```

بریم تو یه مثال ببنیم هر کدومش چیه:

```bash
#!/bin/bash

users="amir dani nazi"

for user in ${users}
do
    echo "${user}"
done
```

حالا بریم دقیق بررسی کنیم روی مثال:

* ما اول اومدیم یه شبه آرایه ساختیم و ریختیمش توی `users` ، لیست کاربرا بر اساس فاصله از هم جدا شدن.
* بعدش اومدیم و از کلمه کلیدی `for` برای شروع حلقه استفاده کردیم.
* بعد از کلمه کلیدی `for` اومدیم و یه متغیر جدید ساختیم به نام `user` که نشون دهنده یه عضو از اون لیسته. (هربار که داخل حلقه رفت یکی از عضو های لیست رو داخل متغیر قرار میده، تا زمانی که به آخرین عضو لیست برسه)
* بعدش از کلمه `in` استفاده میکنیم و در آخر اون لیستی که میخوایم حلقه روش تکرار رو انجام بده.
* بعد از موارد بالا از کلمه کلیدی `do` استفاده میکنیم تا بگیم حلقه باید دقیقا چه دستوراتی رو اجرا کنه.
* حالا دستوراتی که میخوایم اجرا کنیم رو مینویسم، که توی مثال بالا فقط اسامی رو چاپ میکنیم.
* و هروقت دستوراتمون تموم شد، برای بسته شدن حلقه از `done` استفاده میکنیم.

حالا بریم یه مثال عددی بزنیم، مثلا تو مثال زیر میخوایم اعداد 1 تا 10 رو چاپ کنیم:

```bash
#!/bin/bash

for num in {1..10}
do
    echo ${num}
done
```

> وقتی نوشتیم `{1..10}` یعنی متغیر `num` توی هر دور از حلقه یدونه یدونه میره جلو، اول 1 رو برمیداره، دوم 2 و الی آخر.

## حلقه while - While loops

ساختار حلقه `while` هم تقریبا شبیه `for` عه، اما از حلقه while برای زمانی استفاده میکنیم که **شرط** داریم!

> حلقه `for` تکرار رو برای یه لیست معین انجام میده.

> حلقه `while` زمانی استفاده میشه که ما دقیقا نمیدونیم تکرار چقدره، اما برای تعداد تکرار یه شرطی داریم!

```bash
while [ your_condition ]
do
    your_commands
done
```

حالا هم یه مثال براش بزنیم:

```bash
#!/bin/bash

counter=1
while [[ $counter -le 10 ]]
do
    echo $counter
    ((counter++))
done
```

بریم ببنیم اسکریپت بالا چجوری کار میکنه:

* اول اومدیم یه متغیر به نام counter ایجاد کردیم و مقدار اولیه اش رو برابر با `1` گذاشتیم.
* بعد اومدیم از کلمه کلیدی `while` استفاده کردیم و جلوش شرطمون رو گذاشتیم (تا زمانی که counter کوچیک تر مساوی 10 باشه حلقه تکرار میشه)
* باز اومدیم از `do` استفاده کردیم تا دستوراتمون رو بعدش بزاریم
* اول متغیر رو چاپ میکنیم، و بعدش با استفاده از `((counter++))` یه واحد به متغیرمون اضافه میکنیم (اگه این کارو نکنیم متغیر ما همیشه مقدارش برابر با 1 عه و شرطمون هم همیشه درسته، پس هیچ وقت از حلقه کوفتی بیرون نمیایم).
* حالا وقتی متغیرمون به 11 رسید از حلقه خارج میشه، چون دیگه شرط حلقمون درست نیست!

حالا بریم باهم یه اسکریپت بنویسیم که اول اسم کاربر رو بپرسه و اگه ورودی خالی باشه یبار دیگه بپرسه، تا زمانی که کاربر بلخره مثل آدم جواب بده!:

```bash
#!/bin/bash

read -p "What is your name? " name

while [[ -z ${name} ]]
do
    echo "Your name can not be blank. Please enter a valid name!"
    read -p "Enter your name again? " name
done

echo "Hi there ${name}"
```

تو مثال بالا خیلی دقیق متوجه میشید که چرا گفتم `while` برای تکرار هاییه که نمیدونیم تعداشون چقدره!

## حلقه until - Until Loops

این حلقه هم ساختارش دقیقا شبیه حلقه `while` عه، اما یه فرق اساسی داره! اونم اینه که دستورات رو تا زمانی اجرا میکنه که شرط درست بشه! یعنی اگه شرط غلط باشه، حلقه تکرار میشه، و اگه شرط درست بشه، از حلقه خارج میشه (در واثع برعکس while کار میکنه).

ساختارش که مشابه است:

```bash
until [[ your_condition ]]
do
    your_commands
done
```

یه مثال بزنیم لذت ببریم:

```bash
#!/bin/bash

count=1
until [[ $count -gt 10 ]]
do
    echo $count
    ((count++))
done
```

بررسی کنیم چی شد:

* بازم اول یه متغیر ساختیم و بخش مقدار 1 رو دادیم
* بعد اومدیم از کلمه کلیدی `until` استفاده کردیم و شرطمون رو جلوش گذاشتیم
* بعد از `do` استفاده کردیم و توش دستوراتمونو ریختیم.
* توی دستورات هم متغیرمون رو یدونه بهش اضافه کردیم (توی هر دور حلقه).

> توی دور اول متغیر ما برابر 1 عه و از بزرگتر نیست! پس شرط حلقه نادرسته، پس حلقه اجرا میشه. تو دور دوم متغیر ما یدونه بهش اضافه شده و شده 2 ولی بازم شرط حلقه نادرسته، پس بازم تکرار انجام میشه. این کار تا زمانی که متغیر ما به 11 برسه تکرار میشه، حالا 11 از 10 بزرگتره، پس دیگه شرط درسته! پس حلقه به کارش پایان میده.

## کلمات کلیدی Continue و Break

* کلمه کلید `continue` چیکار میکنه؟ فرض کنید توی دستورات حلقتون یه شرط دارید و گفتید اگه متغیر من مثلا برابر با 13 شد، دستورات حلقه رو اجرا نکن و برو به دور بعدیه حلقه! یعنی از کلمه کلیدی `continue` زمانی استفاده میشه که میخواید تکرار فعلی حلقه رو متوقف کنید و تکرار بعدیش رو شروع کنید.

ساختارش توی bash به این صورته:

```bash
continue [n]
```

توی ساختار بالا `[n]` رو داریم که آرگومان اختیاریه. اما کارش چیه؟ شما میتونید جای `[n]` عدد 1 یا بزرگتر از 1 رو بزارید. و حلقه به اون دور از حلقه میره (برای حلقه های تو در تو استفاده میشه! یعنی اگه مثلا 3 تا حلقه داخل هم داشته باشید و توی داخلی ترین حلقه بزارید continue 2 به دور بعدیه دومین حلقه بیرونی میره (اولین حلقه همون حلقه است و دومین حلقه، حلقه خارجیش و سومین حلقه، دوتا حلقه ی خارجیش، الی آخر).)

> همچنین توجه کنید که continue معادل همون continue 1 عه.

```bash
#!/bin/bash

for i in 1 2 3 4 5
do
    if [[ $i -eq 2 ]] 
    then
        echo "skipping number 2"
        continue
    fi
    echo "i is equal to $i"
done
```

توی اسکریپت بالا وقتی متغیر `i` برابر با 2 بشه، وارد `if` میشیم و اونجا از اون دور حلقه میپریم روی دور بعدیش

> توی مثال بالا `1 2 3 4 5` معادل همون `{1..5}` عه


* در مقابل continue کلمه کلیدی `break` رو داریم که اگه ازش استفاده کنید، میتونید فورا از حلقه خارج بشید.

سینتکسش دقیقا شبیه continue عه:

```bash
break [n]
```

اینجا هم `[n]` اختیاریه و دقیقا مثلا continue کار میکنه. (اگه 3 تا حلقه داخل هم داشته باشیم، اگه توی داخلی ترین حلقه بزنیم break از همون حلقه خارج میشه! اگه بزنیم break 2 از حلقه بالا سریش خارج میشه و همینجوری الی آخر میره جلو)

یه مثال بزنیم براش:

```bash
#!/bin/bash

num=1
while [[ $num -lt 10 ]] 
do
    if [[ $num -eq 5 ]] 
    then
        break
    fi
    ((num++))
done
echo "Loop completed"
```

بریم یه مثال بزنیم برای اون آرگومان اختیاری که درک بهتری داشته باشیم:

```bash
#!/bin/bash

for (( a = 1; a < 10; a++ ))
do
    echo "outer loop: $a"
    for (( b = 1; b < 100; b++ ))
    do
        if [[ $b -gt 5 ]] 
        then
            break 2
        fi
        echo "Inner loop: $b "
    done
done
```

توی مثال بالا از `break 2` استفاده کردیم و این یعنی از حلقه بالاسری خارج شو، و نه همین حلقه! پس با این کار کلا کل حلقه های ما به پایان میرسن. ولی اگه فقط از `break` استفاده میکردیم، فقط از همون حلقه داخلی خارج میشدیم و حلقه خارجی به کار خودش ادامه میداد.

> شاید بگید جلوی حلقه for چرا اینجوریه `(( a = 1; a < 10; a++ ))` این هم یه روش دیگه استفاده از حلقه for عه!

* تو قسمت اولش یه متغیر به نام a ساختیم و مقدار اولیه اش رو گذاشتیم 1. بعدش شرطمون رو گذاشتیم و گفتیم تا زمانی حلقه رو تکرار کن که a کوچیک تر از 10 باشه. و قسمت اخر که a++ داره، یعنی هر دور حلقه که تموم شد یدونه به a اضافه کن تا حلقمون تا بینهایت نره جلو!

> برای یدونه اضافه کردن از `++` و برای یدونه کم کردن از `--` میتونید استفاده کنید.
